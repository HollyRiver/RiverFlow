<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="강신성">
<meta name="dcterms.date" content="2023-10-26">

<title>RiverFlow - 오버피팅, 다중공선성</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">RiverFlow</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../2023_MP.html" rel="" target="">
 <span class="menu-text">2023 MP</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../2023_DV.html" rel="" target="">
 <span class="menu-text">2023 DV</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/HollyRiver?tab=repositories" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://blog.naver.com/hc_ssk2800" rel="" target=""><i class="bi bi-book" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">오버피팅, 다중공선성</h1>
  <div class="quarto-categories">
    <div class="quarto-category">linear_model</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>강신성 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2023-10-26</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<blockquote class="blockquote">
<p>오버피팅은 뭐고, 다중공선성은 왜 발생할까? 그리고 해결은 어떻게 할까?</p>
</blockquote>
<section id="해당-자료는-전북대학교-통계학과-최규빈-교수님의-강의-내용을-토대로-재구성되었음을-밝힙니다." class="level6">
<h6 class="anchored" data-anchor-id="해당-자료는-전북대학교-통계학과-최규빈-교수님의-강의-내용을-토대로-재구성되었음을-밝힙니다.">해당 자료는 전북대학교 통계학과 최규빈 교수님의 강의 내용을 토대로 재구성되었음을 밝힙니다.</h6>
</section>
<section id="라이브러리-imports" class="level2">
<h2 class="anchored" data-anchor-id="라이브러리-imports">1. 라이브러리 imports</h2>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn.linear_model</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="언더라잉과-오차항" class="level2">
<h2 class="anchored" data-anchor-id="언더라잉과-오차항">2. 언더라잉과 오차항</h2>
<p>- 만약 내가 원한다면, 관련이 있든 없든 무수히 많은 데이터를 모을 수 있다고 가정하자…</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'https://raw.githubusercontent.com/guebin/MP2023/main/posts/employment.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>df_balance <span class="op">=</span> pd.DataFrame((np.random.randn(<span class="dv">500</span>,<span class="dv">5000</span>)<span class="op">&gt;</span><span class="fl">0.5</span>).reshape(<span class="dv">500</span>,<span class="dv">5000</span>)<span class="op">*</span><span class="dv">1</span>,columns <span class="op">=</span> [<span class="st">'X'</span><span class="op">+</span><span class="bu">str</span>(i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5000</span>)])</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>df_merged <span class="op">=</span> pd.concat([df,df_balance],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>df_merged</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">toeic</th>
<th data-quarto-table-cell-role="th">gpa</th>
<th data-quarto-table-cell-role="th">employment</th>
<th data-quarto-table-cell-role="th">X0</th>
<th data-quarto-table-cell-role="th">X1</th>
<th data-quarto-table-cell-role="th">X2</th>
<th data-quarto-table-cell-role="th">X3</th>
<th data-quarto-table-cell-role="th">X4</th>
<th data-quarto-table-cell-role="th">X5</th>
<th data-quarto-table-cell-role="th">X6</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">X4990</th>
<th data-quarto-table-cell-role="th">X4991</th>
<th data-quarto-table-cell-role="th">X4992</th>
<th data-quarto-table-cell-role="th">X4993</th>
<th data-quarto-table-cell-role="th">X4994</th>
<th data-quarto-table-cell-role="th">X4995</th>
<th data-quarto-table-cell-role="th">X4996</th>
<th data-quarto-table-cell-role="th">X4997</th>
<th data-quarto-table-cell-role="th">X4998</th>
<th data-quarto-table-cell-role="th">X4999</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>135</td>
<td>0.051535</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>935</td>
<td>0.355496</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>485</td>
<td>2.228435</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>65</td>
<td>1.179701</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>445</td>
<td>3.962356</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">495</td>
<td>280</td>
<td>4.288465</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">496</td>
<td>310</td>
<td>2.601212</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">497</td>
<td>225</td>
<td>0.042323</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">498</td>
<td>320</td>
<td>1.041416</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">499</td>
<td>375</td>
<td>3.626883</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>500 rows × 5003 columns</p>
</div>
</div>
</div>
<blockquote class="blockquote">
<p><code>employment</code>의 예측과 상관이 없을 개인의 선호, <code>balance_game</code>을 가져왔다. (5000종류)</p>
</blockquote>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">## df_train, df_test =  sklearn.model_selection.train_test_split(test_size = 0.2) 이걸로 해도 된다.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">## step 1</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df_merged.drop([<span class="st">'employment'</span>], axis <span class="op">=</span> <span class="dv">1</span>)[:<span class="dv">400</span>]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>XX <span class="op">=</span> df_merged.drop([<span class="st">'employment'</span>], axis <span class="op">=</span> <span class="dv">1</span>)[<span class="dv">400</span>:]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_merged.employment[:<span class="dv">400</span>]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>yy <span class="op">=</span> df_merged.employment[<span class="dv">400</span>:]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">## step 2</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>predictr <span class="op">=</span> sklearn.linear_model.LogisticRegression()</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">## step 3</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>predictr.fit(X, y)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">## step 4</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>predictr.score(X, y), predictr.score(XX, yy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\hollyriver\anaconda3\envs\py\lib\site-packages\sklearn\linear_model\_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>(1.0, 0.79)</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>쓸모없는 변수(y와 상관관계가 낮은 변수)를 사용해서 오버피팅되었다. train score가 상당히 높게 나왔다.(오차항까지 예측한 상황)</p>
</blockquote>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'https://raw.githubusercontent.com/guebin/MP2023/main/posts/employment.csv'</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop([<span class="st">'employment'</span>], axis <span class="op">=</span> <span class="dv">1</span>)[:<span class="dv">400</span>]</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>XX <span class="op">=</span> df.drop([<span class="st">'employment'</span>], axis <span class="op">=</span> <span class="dv">1</span>)[<span class="dv">400</span>:]</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[[<span class="st">'employment'</span>]][:<span class="dv">400</span>]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>yy <span class="op">=</span> df[[<span class="st">'employment'</span>]][<span class="dv">400</span>:]</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 2</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>prdtr <span class="op">=</span> sklearn.linear_model.LogisticRegression()</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 3</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>prdtr.fit(X,y)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 4</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>prdtr.score(X,y), prdtr.score(XX, yy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\hollyriver\anaconda3\envs\py\lib\site-packages\sklearn\utils\validation.py:1184: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>(0.8925, 0.83)</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>test 데이터에서 스코어가 더 높았다.</p>
</blockquote>
</section>
<section id="다중공선성" class="level2">
<h2 class="anchored" data-anchor-id="다중공선성">3. 다중공선성</h2>
<p>- 아래와 같은 가짜뉴스를 읽어보자.(ChatGPT를 이용하여 생성한 가짜뉴스)</p>
<p>헤드라인: <strong>“텝스와 다른 영어 인증 시험들, 결국은 토익과 비슷한 결과를 보여준다?”</strong></p>
<p>본문:</p>
<p>최근 몇 년 동안, 토익의 신뢰성에 대한 논란이 계속되어 왔습니다. 이러한 배경 속에서 텝스(TEPS), 토플(TOEFL) 등 여러 새로운 영어 능력 평가 시험이 등장하였습니다. 많은 학생들과 직장인들은 이러한 새로운 시험들이 토익보다 더 신뢰성 있고 현실적인 능력을 평가할 것이라는 기대감을 가지고 있었습니다.</p>
<p>그러나 최근에 발표된 연구결과에 따르면, 텝스와 다른 영어 인증 시험들도 결국에는 토익과 매우 비슷한 성적 분포와 결과를 보여주었다고 합니다. 연구 팀은 여러 시험들간의 점수 분포와 성적의 상관관계를 분석한 결과, 대부분의 시험들이 실제 영어 능력에 대해 유사한 평가를 제공한다는 결론을 내렸습니다.</p>
<p>“많은 사람들이 새로운 시험들이 더 현실적이거나 다양한 영어 능력을 평가할 것이라 기대했지만, 실제로는 모든 시험들이 비슷한 결과를 보여주었습니다.” 라며 연구 팀의 대표는 이렇게 언급하였습니다.</p>
<p>이러한 연구결과는 영어 능력 평가 시험의 표준화와 신뢰성에 대한 논의를 새롭게 불러일으킬 것으로 보입니다.</p>
<p>- 뉴스에 근거하여 아래의 가짜 자료를 생성했다.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"https://raw.githubusercontent.com/guebin/MP2023/main/posts/employment_multicollinearity.csv"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">employment_score</th>
<th data-quarto-table-cell-role="th">gpa</th>
<th data-quarto-table-cell-role="th">toeic</th>
<th data-quarto-table-cell-role="th">toeic0</th>
<th data-quarto-table-cell-role="th">toeic1</th>
<th data-quarto-table-cell-role="th">toeic2</th>
<th data-quarto-table-cell-role="th">toeic3</th>
<th data-quarto-table-cell-role="th">toeic4</th>
<th data-quarto-table-cell-role="th">toeic5</th>
<th data-quarto-table-cell-role="th">toeic6</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">toeic490</th>
<th data-quarto-table-cell-role="th">toeic491</th>
<th data-quarto-table-cell-role="th">toeic492</th>
<th data-quarto-table-cell-role="th">toeic493</th>
<th data-quarto-table-cell-role="th">toeic494</th>
<th data-quarto-table-cell-role="th">toeic495</th>
<th data-quarto-table-cell-role="th">toeic496</th>
<th data-quarto-table-cell-role="th">toeic497</th>
<th data-quarto-table-cell-role="th">toeic498</th>
<th data-quarto-table-cell-role="th">toeic499</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.051535</td>
<td>135</td>
<td>129.566309</td>
<td>133.078481</td>
<td>121.678398</td>
<td>113.457366</td>
<td>133.564200</td>
<td>136.026566</td>
<td>141.793547</td>
<td>...</td>
<td>132.014696</td>
<td>140.013265</td>
<td>135.575816</td>
<td>143.863346</td>
<td>152.162740</td>
<td>132.850033</td>
<td>115.956496</td>
<td>131.842126</td>
<td>125.090801</td>
<td>143.568527</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.355496</td>
<td>935</td>
<td>940.563187</td>
<td>935.723570</td>
<td>939.190519</td>
<td>938.995672</td>
<td>945.376482</td>
<td>927.469901</td>
<td>952.424087</td>
<td>...</td>
<td>942.251184</td>
<td>923.241548</td>
<td>939.924802</td>
<td>921.912261</td>
<td>953.250300</td>
<td>931.743615</td>
<td>940.205853</td>
<td>930.575825</td>
<td>941.530348</td>
<td>934.221055</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>2.228435</td>
<td>485</td>
<td>493.671390</td>
<td>493.909118</td>
<td>475.500970</td>
<td>480.363752</td>
<td>478.868942</td>
<td>493.321602</td>
<td>490.059102</td>
<td>...</td>
<td>484.438233</td>
<td>488.101275</td>
<td>485.626742</td>
<td>475.330715</td>
<td>485.147363</td>
<td>468.553780</td>
<td>486.870976</td>
<td>481.640957</td>
<td>499.340808</td>
<td>488.197332</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>1.179701</td>
<td>65</td>
<td>62.272565</td>
<td>55.957257</td>
<td>68.521468</td>
<td>76.866765</td>
<td>51.436321</td>
<td>57.166824</td>
<td>67.834920</td>
<td>...</td>
<td>67.653225</td>
<td>65.710588</td>
<td>64.146780</td>
<td>76.662194</td>
<td>66.837839</td>
<td>82.379018</td>
<td>69.174745</td>
<td>64.475993</td>
<td>52.647087</td>
<td>59.493275</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>3.962356</td>
<td>445</td>
<td>449.280637</td>
<td>438.895582</td>
<td>433.598274</td>
<td>444.081141</td>
<td>437.005100</td>
<td>434.761142</td>
<td>443.135269</td>
<td>...</td>
<td>455.940348</td>
<td>435.952854</td>
<td>441.521145</td>
<td>443.038886</td>
<td>433.118847</td>
<td>466.103355</td>
<td>430.056944</td>
<td>423.632873</td>
<td>446.973484</td>
<td>442.793633</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">495</td>
<td>NaN</td>
<td>4.288465</td>
<td>280</td>
<td>276.680902</td>
<td>274.502675</td>
<td>277.868536</td>
<td>292.283300</td>
<td>277.476630</td>
<td>281.671647</td>
<td>296.307373</td>
<td>...</td>
<td>269.541846</td>
<td>278.220546</td>
<td>278.484758</td>
<td>284.901284</td>
<td>272.451612</td>
<td>265.784490</td>
<td>275.795948</td>
<td>280.465992</td>
<td>268.528889</td>
<td>283.638470</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">496</td>
<td>NaN</td>
<td>2.601212</td>
<td>310</td>
<td>296.940263</td>
<td>301.545000</td>
<td>306.725610</td>
<td>314.811407</td>
<td>311.935810</td>
<td>309.695838</td>
<td>301.979914</td>
<td>...</td>
<td>304.680578</td>
<td>295.476836</td>
<td>316.582100</td>
<td>319.412132</td>
<td>312.984039</td>
<td>312.372112</td>
<td>312.106944</td>
<td>314.101927</td>
<td>309.409533</td>
<td>297.429968</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">497</td>
<td>NaN</td>
<td>0.042323</td>
<td>225</td>
<td>206.793217</td>
<td>228.335345</td>
<td>222.115146</td>
<td>216.479498</td>
<td>227.469560</td>
<td>238.710310</td>
<td>233.797065</td>
<td>...</td>
<td>233.469238</td>
<td>235.160919</td>
<td>228.517306</td>
<td>228.349646</td>
<td>224.153606</td>
<td>230.860484</td>
<td>218.683195</td>
<td>232.949484</td>
<td>236.951938</td>
<td>227.997629</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">498</td>
<td>NaN</td>
<td>1.041416</td>
<td>320</td>
<td>327.461442</td>
<td>323.019899</td>
<td>329.589337</td>
<td>313.312233</td>
<td>315.645050</td>
<td>324.448247</td>
<td>314.271045</td>
<td>...</td>
<td>326.297700</td>
<td>309.893822</td>
<td>312.873223</td>
<td>322.356584</td>
<td>319.332809</td>
<td>319.405283</td>
<td>324.021917</td>
<td>312.363694</td>
<td>318.493866</td>
<td>310.973930</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">499</td>
<td>NaN</td>
<td>3.626883</td>
<td>375</td>
<td>370.966595</td>
<td>364.668477</td>
<td>371.853566</td>
<td>373.574930</td>
<td>376.701708</td>
<td>356.905085</td>
<td>354.584022</td>
<td>...</td>
<td>382.278782</td>
<td>379.460816</td>
<td>371.031640</td>
<td>370.272639</td>
<td>375.618182</td>
<td>369.252740</td>
<td>376.925543</td>
<td>391.863103</td>
<td>368.735260</td>
<td>368.520844</td>
</tr>
</tbody>
</table>

<p>500 rows × 503 columns</p>
</div>
</div>
</div>
<blockquote class="blockquote">
<p><code>toeic0</code> ~ <code>toeic499</code>는 유사토익을 의미</p>
</blockquote>
<p>- 모르는 정보 : 사내 고용 법칙</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">43052</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'employment_score'</span>] <span class="op">=</span> df.gpa <span class="op">*</span> <span class="fl">1.0</span> <span class="op">+</span> df.toeic <span class="op">*</span> <span class="dv">1</span><span class="op">/</span><span class="dv">100</span> <span class="op">+</span> np.random.randn(<span class="dv">500</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">employment_score</th>
<th data-quarto-table-cell-role="th">gpa</th>
<th data-quarto-table-cell-role="th">toeic</th>
<th data-quarto-table-cell-role="th">toeic0</th>
<th data-quarto-table-cell-role="th">toeic1</th>
<th data-quarto-table-cell-role="th">toeic2</th>
<th data-quarto-table-cell-role="th">toeic3</th>
<th data-quarto-table-cell-role="th">toeic4</th>
<th data-quarto-table-cell-role="th">toeic5</th>
<th data-quarto-table-cell-role="th">toeic6</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">toeic490</th>
<th data-quarto-table-cell-role="th">toeic491</th>
<th data-quarto-table-cell-role="th">toeic492</th>
<th data-quarto-table-cell-role="th">toeic493</th>
<th data-quarto-table-cell-role="th">toeic494</th>
<th data-quarto-table-cell-role="th">toeic495</th>
<th data-quarto-table-cell-role="th">toeic496</th>
<th data-quarto-table-cell-role="th">toeic497</th>
<th data-quarto-table-cell-role="th">toeic498</th>
<th data-quarto-table-cell-role="th">toeic499</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.784955</td>
<td>0.051535</td>
<td>135</td>
<td>129.566309</td>
<td>133.078481</td>
<td>121.678398</td>
<td>113.457366</td>
<td>133.564200</td>
<td>136.026566</td>
<td>141.793547</td>
<td>...</td>
<td>132.014696</td>
<td>140.013265</td>
<td>135.575816</td>
<td>143.863346</td>
<td>152.162740</td>
<td>132.850033</td>
<td>115.956496</td>
<td>131.842126</td>
<td>125.090801</td>
<td>143.568527</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10.789671</td>
<td>0.355496</td>
<td>935</td>
<td>940.563187</td>
<td>935.723570</td>
<td>939.190519</td>
<td>938.995672</td>
<td>945.376482</td>
<td>927.469901</td>
<td>952.424087</td>
<td>...</td>
<td>942.251184</td>
<td>923.241548</td>
<td>939.924802</td>
<td>921.912261</td>
<td>953.250300</td>
<td>931.743615</td>
<td>940.205853</td>
<td>930.575825</td>
<td>941.530348</td>
<td>934.221055</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>8.221213</td>
<td>2.228435</td>
<td>485</td>
<td>493.671390</td>
<td>493.909118</td>
<td>475.500970</td>
<td>480.363752</td>
<td>478.868942</td>
<td>493.321602</td>
<td>490.059102</td>
<td>...</td>
<td>484.438233</td>
<td>488.101275</td>
<td>485.626742</td>
<td>475.330715</td>
<td>485.147363</td>
<td>468.553780</td>
<td>486.870976</td>
<td>481.640957</td>
<td>499.340808</td>
<td>488.197332</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2.137594</td>
<td>1.179701</td>
<td>65</td>
<td>62.272565</td>
<td>55.957257</td>
<td>68.521468</td>
<td>76.866765</td>
<td>51.436321</td>
<td>57.166824</td>
<td>67.834920</td>
<td>...</td>
<td>67.653225</td>
<td>65.710588</td>
<td>64.146780</td>
<td>76.662194</td>
<td>66.837839</td>
<td>82.379018</td>
<td>69.174745</td>
<td>64.475993</td>
<td>52.647087</td>
<td>59.493275</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>8.650144</td>
<td>3.962356</td>
<td>445</td>
<td>449.280637</td>
<td>438.895582</td>
<td>433.598274</td>
<td>444.081141</td>
<td>437.005100</td>
<td>434.761142</td>
<td>443.135269</td>
<td>...</td>
<td>455.940348</td>
<td>435.952854</td>
<td>441.521145</td>
<td>443.038886</td>
<td>433.118847</td>
<td>466.103355</td>
<td>430.056944</td>
<td>423.632873</td>
<td>446.973484</td>
<td>442.793633</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">495</td>
<td>9.057243</td>
<td>4.288465</td>
<td>280</td>
<td>276.680902</td>
<td>274.502675</td>
<td>277.868536</td>
<td>292.283300</td>
<td>277.476630</td>
<td>281.671647</td>
<td>296.307373</td>
<td>...</td>
<td>269.541846</td>
<td>278.220546</td>
<td>278.484758</td>
<td>284.901284</td>
<td>272.451612</td>
<td>265.784490</td>
<td>275.795948</td>
<td>280.465992</td>
<td>268.528889</td>
<td>283.638470</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">496</td>
<td>4.108020</td>
<td>2.601212</td>
<td>310</td>
<td>296.940263</td>
<td>301.545000</td>
<td>306.725610</td>
<td>314.811407</td>
<td>311.935810</td>
<td>309.695838</td>
<td>301.979914</td>
<td>...</td>
<td>304.680578</td>
<td>295.476836</td>
<td>316.582100</td>
<td>319.412132</td>
<td>312.984039</td>
<td>312.372112</td>
<td>312.106944</td>
<td>314.101927</td>
<td>309.409533</td>
<td>297.429968</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">497</td>
<td>2.430590</td>
<td>0.042323</td>
<td>225</td>
<td>206.793217</td>
<td>228.335345</td>
<td>222.115146</td>
<td>216.479498</td>
<td>227.469560</td>
<td>238.710310</td>
<td>233.797065</td>
<td>...</td>
<td>233.469238</td>
<td>235.160919</td>
<td>228.517306</td>
<td>228.349646</td>
<td>224.153606</td>
<td>230.860484</td>
<td>218.683195</td>
<td>232.949484</td>
<td>236.951938</td>
<td>227.997629</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">498</td>
<td>5.343171</td>
<td>1.041416</td>
<td>320</td>
<td>327.461442</td>
<td>323.019899</td>
<td>329.589337</td>
<td>313.312233</td>
<td>315.645050</td>
<td>324.448247</td>
<td>314.271045</td>
<td>...</td>
<td>326.297700</td>
<td>309.893822</td>
<td>312.873223</td>
<td>322.356584</td>
<td>319.332809</td>
<td>319.405283</td>
<td>324.021917</td>
<td>312.363694</td>
<td>318.493866</td>
<td>310.973930</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">499</td>
<td>6.505106</td>
<td>3.626883</td>
<td>375</td>
<td>370.966595</td>
<td>364.668477</td>
<td>371.853566</td>
<td>373.574930</td>
<td>376.701708</td>
<td>356.905085</td>
<td>354.584022</td>
<td>...</td>
<td>382.278782</td>
<td>379.460816</td>
<td>371.031640</td>
<td>370.272639</td>
<td>375.618182</td>
<td>369.252740</td>
<td>376.925543</td>
<td>391.863103</td>
<td>368.735260</td>
<td>368.520844</td>
</tr>
</tbody>
</table>

<p>500 rows × 503 columns</p>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>학점 1 증가는 토익 100점 증가와 비슷하다고 고려하고 있다.</p>
</blockquote>
<section id="a.-이대로-분석-잘못됨" class="level3">
<h3 class="anchored" data-anchor-id="a.-이대로-분석-잘못됨"><strong>A. 이대로 분석 | 잘못됨</strong></h3>
<hr>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">## step 1</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df_train, df_test <span class="op">=</span> sklearn.model_selection.train_test_split(df, test_size <span class="op">=</span> <span class="fl">0.3</span>, random_state <span class="op">=</span> <span class="dv">42</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df_train.drop([<span class="st">'employment_score'</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_train.employment_score</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>XX <span class="op">=</span> df_test.drop([<span class="st">'employment_score'</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>yy <span class="op">=</span> df_test.employment_score</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">## step 2</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>predictr <span class="op">=</span> sklearn.linear_model.LinearRegression()</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">## step 3</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>predictr.fit(X, y)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">## step 4</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>predictr.score(X, y), predictr.score(XX, yy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>(1.0, 0.11705078212495712)</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>두 점수가 큰 차이가 난다.(오차항까지 적합해버린 오버피팅의 상황)</p>
</blockquote>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> pd.Series(predictr.coef_)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>s.set_axis(X.columns, axis <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>gpa         0.035315
toeic       0.002680
toeic0      0.009333
toeic1     -0.017511
toeic2      0.005205
              ...   
toeic495   -0.012811
toeic496   -0.007390
toeic497   -0.007487
toeic498    0.003379
toeic499   -0.002187
Length: 502, dtype: float64</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>실제로는 gpa는 1, toeic은 0.01, 나머지는 0이 되어야 하지만, 많이 다르다…</p>
</blockquote>
</section>
</section>
<section id="b.-제대로-분석했다면" class="level2">
<h2 class="anchored" data-anchor-id="b.-제대로-분석했다면">### <strong>B. 제대로 분석했다면?</strong></h2>
<p>- <code>toeic</code>과 <code>gpa</code>만이 유의미한 변수라는 걸 눈치챔. (아다리, 현실세계에선 일어날 수 없음)</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">## step 1</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>df_train, df_test <span class="op">=</span> sklearn.model_selection.train_test_split(df, test_size <span class="op">=</span> <span class="fl">0.3</span>, random_state <span class="op">=</span> <span class="dv">42</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df_train.loc[:, [<span class="st">'toeic'</span>, <span class="st">'gpa'</span>]]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_train.employment_score</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>XX <span class="op">=</span> df_test.loc[:, [<span class="st">'toeic'</span>, <span class="st">'gpa'</span>]]</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>yy <span class="op">=</span> df_test.employment_score</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">## step 2</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>predictr <span class="op">=</span> sklearn.linear_model.LinearRegression()</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">## step 3</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>predictr.fit(X, y)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">## step 4</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>predictr.score(X, y), predictr.score(XX, yy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>(0.9133033622085311, 0.9127346436925985)</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>스코어도 높음</p>
</blockquote>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> pd.Series(predictr.coef_)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>s.set_axis(X.columns, axis <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>toeic    0.010063
gpa      0.972163
dtype: float64</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>실제 계수값과 유사하도록 잘 추정됨</p>
</blockquote>
<section id="c.-하다못해-toeic0와-gpa로-적합했다면" class="level3">
<h3 class="anchored" data-anchor-id="c.-하다못해-toeic0와-gpa로-적합했다면"><strong>C. 하다못해 <code>toeic0</code>와 <code>gpa</code>로 적합했다면???</strong></h3>
<hr>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">## step 1</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df_train, df_test <span class="op">=</span> sklearn.model_selection.train_test_split(df, test_size <span class="op">=</span> <span class="fl">0.3</span>, random_state <span class="op">=</span> <span class="dv">42</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df_train.loc[:, [<span class="st">'toeic0'</span>, <span class="st">'gpa'</span>]]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_train.employment_score</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>XX <span class="op">=</span> df_test.loc[:, [<span class="st">'toeic0'</span>, <span class="st">'gpa'</span>]]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>yy <span class="op">=</span> df_test.employment_score</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">## step 2</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>predictr <span class="op">=</span> sklearn.linear_model.LinearRegression()</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">## step 3</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>predictr.fit(X, y)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co">## step 4</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>predictr.score(X, y), predictr.score(XX, yy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>(0.9120540945251211, 0.9115427614193155)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> pd.Series(predictr.coef_)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>s.set_axis(X.columns, axis <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>toeic0    0.010101
gpa       0.981302
dtype: float64</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>굉장히 합리적이다!</p>
</blockquote>
</section>
</section>
<section id="d.-고찰" class="level2">
<h2 class="anchored" data-anchor-id="d.-고찰">### <strong>D. 고찰</strong></h2>
<p>- 의문 : 왜 변수를 더 많이 넣었는데, 정보를 더 많이 제공해줬는데, 이상한 결과가 나올까???</p>
<blockquote class="blockquote">
<p>규칙을 찾으면 안될 것 <strong>(반응변수와의 상관관계가 없는 것)</strong> 에서 규칙을 찾고 있으니까 <strong>(오차항을 적합)</strong> 잘 될리가 없지…</p>
</blockquote>
<p>- 쓸모없는 변수?</p>
<ul>
<li><ol type="1">
<li>진짜 쓰레기, 쓰잘데기 없는 것(X1 = 부먹/찍먹, X2 = 민초/반민초…) -&gt; 애초에 이딴걸 가지고 y를 맞출 생각도 들지 않음…</li>
</ol></li>
<li><ol start="2" type="1">
<li>실제론 쓸모 있는데, 대체제가 있는 경우 -&gt; 대체제를 보고 y를 맞출 것 같기도 한데, 둘은 너무 비슷함…</li>
</ol></li>
</ul>
<p>- 1과 2 모두 과대적합(overfitting)을 야기하고, 2와 같은 상황에서 발생하는 문제를 <span style="background-color:yellow"><strong>다중공선성</strong></span>(multiple linearity)이라고 한다.</p>
<blockquote class="blockquote">
<p>1은 corr(x_1, y), corr(x_2, y)가 낮게 나온다 -&gt; y와의 관계가 없다. 2는 corr(x_1, y), corr(x_2, y)는 높게 나오는데, corr(x_1, x_2)도 높게 나온다.</p>
</blockquote>
</section>
<section id="다중공선성의-특징" class="level2">
<h2 class="anchored" data-anchor-id="다중공선성의-특징">4. 다중공선성의 특징</h2>
<p>- 잘못된 분석을 재현하고, 계수를 해석해보자.</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">## step1: 데이터의 정리  </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>df_train,df_test <span class="op">=</span> sklearn.model_selection.train_test_split(df,test_size<span class="op">=</span><span class="fl">0.3</span>,random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df_train.loc[:,<span class="st">'gpa'</span>:<span class="st">'toeic499'</span>]</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>XX <span class="op">=</span> df_test.loc[:,<span class="st">'gpa'</span>:<span class="st">'toeic499'</span>]</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_train.loc[:,<span class="st">'employment_score'</span>]</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>yy <span class="op">=</span> df_test.loc[:,<span class="st">'employment_score'</span>]</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">## step2: predictor 생성 </span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>predictr <span class="op">=</span> sklearn.linear_model.LinearRegression()</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">## step3: predictor.fit을 이용하여 predictor 학습</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>predictr.fit(X,y)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co">## step4: predictor.predict을 이용하여 예측 -- pass </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">LinearRegression</label><div class="sk-toggleable__content"><pre>LinearRegression()</pre></div></div></div></div></div>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> pd.Series(predictr.coef_)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>s.index <span class="op">=</span> X.columns</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>gpa         0.035315
toeic       0.002680
toeic0      0.009333
toeic1     -0.017511
toeic2      0.005205
              ...   
toeic495   -0.012811
toeic496   -0.007390
toeic497   -0.007487
toeic498    0.003379
toeic499   -0.002187
Length: 502, dtype: float64</code></pre>
</div>
</div>
<p>- 특이사항</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>s.loc[<span class="st">'toeic'</span>:].<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>0.010302732920633051</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>비슷한 설명변수들의 회귀계수를 합하니까 0.01과 유사한 값이 나왔음…</p>
</blockquote>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    df_train, df_test <span class="op">=</span> sklearn.model_selection.train_test_split(df, test_size <span class="op">=</span> <span class="fl">0.3</span>, random_state <span class="op">=</span> i)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> df_train.drop([<span class="st">'employment_score'</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    XX <span class="op">=</span> df_test.drop([<span class="st">'employment_score'</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> df_train.employment_score</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    yy <span class="op">=</span> df_test.employment_score</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    predictr <span class="op">=</span> sklearn.linear_model.LinearRegression()</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    predictr.fit(X, y)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> pd.Series(predictr.coef_)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    ax[i].plot(s[<span class="dv">1</span>:], <span class="st">'-'</span>)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    ax[i].set_title(<span class="st">'sum of toeic coef = </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="bu">round</span>(s[<span class="dv">1</span>:].<span class="bu">sum</span>(), <span class="dv">4</span>)))</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="A5. 오버피팅, 다중공선성_files/figure-html/cell-17-output-1.png" class="img-fluid"></p>
</div>
</div>
<ol type="1">
<li>계수는 상당히 불안정하나, 그 합은 합리적인 값이 나온다.</li>
<li>계수값의 해석이 용이하지 않다. 음의 계수값이 있다는 것은, 토익 유사한 시험의 점수를 올리면 취업이 오히려 안된다<sub>(…)</sub>라는 것과도 같다.</li>
</ol>
<blockquote class="blockquote">
<p>이것의 해결은 직접 몇 개만 지우거나, 다중공선성을 해결하기 위해 패널티를 부여하는 모듈을 써서 해소 가능하다.</p>
</blockquote>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>